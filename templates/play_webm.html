<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebM Video Player</title>
    <!-- OGV.js for .webm playback -->
    <script src="/static/ogvjs-1.9.0/ogv.js"></script>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #191919; /* Dark grey background */
            overflow: hidden;
        }
        .video-container {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        .seek-slider {
            position: absolute;
            bottom: 20px;
            width: 80%;
            z-index: 1;
            display: none;
        }
        #thumbnail {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 2;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Video container with thumbnail -->
    <div class="video-container" id="videoContainer">
        <img id="thumbnail" src="/thumbnails/{{ video_name.replace('.webm', '.jpg') }}" alt="Video Thumbnail">
        <input type="range" id="seekSlider" class="seek-slider" min="0" value="0" step="1"/>
    </div>

    <script>
        var player = new OGVPlayer({
            debug: true
        });

        var containerElement = document.getElementById('videoContainer');
        var thumbnailElement = document.getElementById('thumbnail');
        var seekSlider = document.getElementById('seekSlider');

        // Append player to the container but keep it hidden initially
        containerElement.appendChild(player);
        player.src = '/videos/{{ video_name }}';

        // Function to handle starting video playback and hiding the thumbnail
        function startVideo() {
            thumbnailElement.style.display = 'none'; // Hide the thumbnail
            player.play(); // Start video playback
            seekSlider.style.display = 'block'; // Show the seek slider
        }

        // Add a click event listener to the container
        containerElement.addEventListener('click', function(event) {
            // If the thumbnail is visible, start the video and hide the thumbnail
            if (thumbnailElement.style.display !== 'none') {
                startVideo();
            } else {
                // Toggle play/pause if the thumbnail is already hidden
                if (event.target !== seekSlider) {
                    if (player.paused) {
                        player.play();
                    } else {
                        player.pause();
                    }
                }
            }
        });

        // Adjust video element size when loaded
        player.addEventListener('loadedmetadata', function() {
            var videoElement = containerElement.querySelector('video, ogvjs-player');
            if (videoElement) {
                videoElement.style.width = '100%';
                videoElement.style.height = '100%';
                videoElement.style.maxWidth = 'none';
                videoElement.style.maxHeight = 'none';
                videoElement.style.objectFit = 'cover';
                videoElement.style.position = 'absolute';
                videoElement.style.top = '0';
                videoElement.style.left = '0';
                videoElement.style.zIndex = '1'; // Ensure video is behind the thumbnail initially
            }

            // Set the max value for the seek slider
            seekSlider.max = player.duration;
        });

        // Update the seek slider as the video plays
        player.addEventListener('timeupdate', function() {
            seekSlider.value = player.currentTime;
        });

        // Handle seek slider input
        seekSlider.addEventListener('input', function() {
            player.currentTime = this.value;
        });
    </script>
</body>
</html>
